# Application to real hERG data

All results are cached, so all figures can be re-generated by simply running the figure plots.
All results for Hypothesis 2 can be reproduced by running:

1. Run `fit-fix-kinetics-simvclinleak.sh` to get initial guesses for the artefact parameters.
2. Run `fit-simvclinleak-scheme3-parallel.py` to run [fits](out/herg25oc1-scheme3-simvclinleak) with Eq. (4.14) using Algorithm S1.
3. Run `compute-rmsd-hist-fix-kinetics-simvclinleak-scheme3.py` to compute all the [RRMSE values](out/rmsd-hist-herg25oc1-fixkinetics-simvclinleak-scheme3).

[Figure 7](figs/rmsd-hist-fix-kinetics-simvclinleak-scheme3-part1.pdf), Table S4: Run `plot-rmsd-hist-fix-kinetics-simvclinleak-scheme3-part1.py` to generate Figure 7 and Table S4.

[Figure 8](figs/herg25oc1-simvclinleak-scheme3-fitted-parameters.pdf): Run `plot-fitted-parameters-fix-kinetics-simvclinleak-scheme3.py` to generate Figure 8.

[Figure S7](figs/rmsd-hist-fix-kinetics-simvclinleak-scheme3-part2.png): Run `plot-rmsd-hist-fix-kinetics-simvclinleak-scheme3-part2.py` to generate Figure S7.

[Figure S8](figs/ss-tau.pdf): Run `plot-ss-tau.py` to generate Figure S8.

[Figure S9](figs/hypotheses-comparison-staircase.pdf): Run `plot-staircase-difference.py` to generate Figure S9.

Table S3: Run `print-tex-table.py` to generate Table S3.

### Extra results mentioned but not shown in the paper
Results for [fitting the full voltage-clamp model to data](out/herg25oc1-full2vclinleak): Run `fit-full2vclinleak.sh`.

Results for 'Hypothesis 3':

All results are cached, so all figures can be re-generated by simply running the figure plots.
All results for 'Hypothesis 3' can be reproduced by running:
1. Run `fit-simvclinleak.sh` to reproduce ['Hypothesis 3' results](out/herg25oc1-simvclinleak).
2. Run `compute-rmsd-hist-fit-simvclinleak.py` to recompute all the [RRMSE values for 'Hypothesis 3'](out/rmsd-hist-herg25oc1-fit-simvclinleak).

To re-generate figures:
- [An equivalent of Figure 7 for 'Hypothesis 3'](figs/rmsd-hist-independent-v-scheme3-v-simlinleak-part1.png): Run `plot-rmsd-hist-independent-v-scheme3-v-simlinleak-part1.py`.
- [An equivalent of Figure 8 for 'Hypothesis 3'](figs/herg25oc1-simvclinleak-artefacts.png): Run  `plot-param-fit-simvclinleak-artefacts.py`.
